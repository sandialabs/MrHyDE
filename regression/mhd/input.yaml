# Uses a general formulation of MHD by
# coupling Maxwell's and NS. The coupling terms
# are analytically derived
# Not quite working yet.
%YAML 1.1
---
ANONYMOUS:
  verbosity: 111
  debug level: 111
  Mesh:
    dimension: 3
    element type: hex
    xmin: 0.0
    xmax: 1.0
    ymin: 0.0
    ymax: 1.0
    zmin: 0.0
    zmax: 1.0
    NX: 512
    NY: 2
    NZ: 2
    Periodic BCs:
      Count: 3
      Periodic Condition 1: 'xz-all 1e-10: top;bottom'
      Periodic Condition 2: 'yz-all 1e-10: left;right'
      Periodic Condition 3: 'xy-all 1e-10: front;back'
  Physics:
    modules: 'navier stokes, maxwell'
    assemble boundary terms: false
    Initial conditions:
      ux: '0.00001*sin(2*pi*x)*( -2.00000000000000)'
      uy: '0.00001*sin(2*pi*x)*(0.9428090415820636)'
      uz: '0.00001*sin(2*pi*x)*(0.3333333333333333)'
      'B[x]': '1'
      'B[y]': '1.41421-0.00001*sin(2*pi*x)*(0.8432740427115680)'
      'B[z]': '0.5    +0.00001*sin(2*pi*x)*(2.9814239699997200)'
      'E[x]': 'curl(B)[x]/sigma - (uy*B[z]-uz*B[y])'
      'E[y]': 'curl(B)[y]/sigma - (uz*B[x]-ux*B[z])'
      'E[z]': 'curl(B)[z]/sigma - (ux*B[y]-uy*B[x])'
      pr: '0.6 + 0.00001*cos(2*pi*x)'
    usePSPG: true
  Discretization:
    order:
      ux: 1
      uy: 1
      uz: 1
      B: 1
      E: 1
      pr: 1
    quadrature: 2
   Solver:
    solver: transient
    transient BDF order: 1
    itransient Butcher tableau: DIRK-1,2
    transient Butcher tableau: BWE
    workset size: 200
    nonlinear TOL: 1.0e-9
    linear TOL: 1.0e-9
    max nonlinear iters: 1
    max linear iters: 2000
    use direct solver: false
    use domain decomposition: true
    use preconditioner: true
    # preconditioner reuse type: full
    # Preconditioner Settings:
    #   verbosity: none
    #   number of equations: 10
    #   'problem: type': MHD
    final time: 5.0
    delta t: 0.01
  Analysis:
    analysis type: forward
  Functions input file: input_functions.yaml
  Parameters input file: input_parameters.yaml
  Postprocess:
    write solution: true
    output file: output
...
